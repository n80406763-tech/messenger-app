<!-- @format -->

<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"
    />
    <meta name="theme-color" content="#2563eb" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Messenger" />
    <title>Messenger</title>
    <link rel="manifest" href="/manifest.webmanifest" />
    <link rel="apple-touch-icon" href="/icon-192.svg" />
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <span class="app-version" id="appVersion">v1.2.0</span>

    <main class="app">
      <section id="authPanel" class="auth card">
        <h1>Messenger</h1>
        <p>Вход в аккаунт</p>
        <input
          id="username"
          type="text"
          placeholder="username"
          autocomplete="username"
        />
        <input
          id="password"
          type="password"
          placeholder="password"
          autocomplete="current-password"
        />
        <div class="row">
          <button id="loginBtn">Войти</button>
          <button id="registerBtn" class="secondary">Регистрация</button>
        </div>
        <p id="authMessage" class="muted"></p>
      </section>

      <section id="chatPanel" class="chat hidden">
        <aside class="sidebar card">
          <div class="tabs" id="sidebarTabs">
            <button id="tabChatsBtn" class="tab active" type="button">
              Чаты
            </button>
            <button id="tabContactsBtn" class="tab" type="button">
              Контакты
            </button>
            <button id="tabSettingsBtn" class="tab" type="button">
              Настройки
            </button>
          </div>

          <div class="sidebar-header">
            <strong id="meLabel"></strong>
            <button id="openSettingsBtn" class="secondary">Настройки</button>
            <button id="logoutBtn" class="danger">Выйти</button>
          </div>

          <div id="chatsSection">
            <h3>Окно чатов</h3>
            <div class="actions-wrap" id="chatsSectionActions">
              <button id="openCreateGroupBtn" class="secondary">
                Новая группа
              </button>
            </div>
            <input
              id="conversationSearchInput"
              type="text"
              placeholder="Поиск по чатам"
            />
            <div id="conversationsList" class="conversations"></div>
            <button id="supportChatBtn" class="ghost support-btn">
              Чат поддержки
            </button>
          </div>

          <div class="search-wrap hidden" id="contactsSection">
            <h3>Окно контактов</h3>
            <input id="userSearchInput" type="text" placeholder="Поиск людей" />
            <div id="userSearchResults" class="results"></div>
          </div>

          <div id="settingsSection" class="hidden">
            <h3>Все настройки</h3>
            <p class="muted">
              Профиль, приватность, push и UI-настройки — в одном окне.
            </p>
            <div class="actions-wrap">
              <button id="openSettingsBtnTab" class="secondary">
                Открыть окно настроек
              </button>
              <button id="supportChatBtnTab" class="ghost">
                Чат поддержки
              </button>
              <button id="logoutBtnTab" class="danger">Выйти</button>
            </div>
          </div>
        </aside>

        <section class="dialog card">
          <div class="dialog-header">
            <div>
              <button
                id="backToListBtn"
                class="ghost back-btn hidden"
                type="button"
              >
                ← Назад к чатам
              </button>
              <h2 id="dialogTitle">Выберите чат</h2>
              <p id="dialogMeta" class="muted"></p>
              <div id="supportActions" class="support-actions hidden"></div>
            </div>
            <div class="dialog-actions">
              <button id="openGroupSettingsBtn" class="secondary hidden">
                Настройки группы
              </button>
              <span id="connBadge" class="badge">offline</span>
            </div>
          </div>

          <button id="loadOlderBtn" class="ghost hidden">
            Загрузить старые сообщения
          </button>
          <div id="messages" class="messages"></div>

          <form id="messageForm" class="composer">
            <textarea
              id="messageInput"
              placeholder="Введите сообщение"
            ></textarea>
            <div id="mediaPreview" class="media-preview hidden"></div>
            <div class="composer-row">
              <input id="mediaInput" type="file" accept="image/*,video/*" />
              <button type="submit">Отправить</button>
            </div>
          </form>
          <p id="chatMessage" class="muted"></p>
        </section>
      </section>

      <footer class="app-footer">created by Netrender Studios</footer>
    </main>

    <div id="groupModal" class="modal hidden">
      <div class="modal-card">
        <h3 id="groupModalTitle">Создать группу</h3>
        <input id="groupTitleInput" type="text" placeholder="Название группы" />
        <input
          id="groupMemberSearchInput"
          type="text"
          placeholder="Поиск участников"
        />
        <div id="groupMemberCandidates" class="results"></div>
        <div id="selectedGroupMembers" class="chips"></div>
        <div class="row">
          <button id="saveGroupBtn">Сохранить</button>
          <button id="cancelGroupBtn" class="secondary" type="button">
            Отмена
          </button>
        </div>
      </div>
    </div>

    <div id="settingsModal" class="modal hidden">
      <div class="modal-card">
        <h3>Единое окно настроек</h3>

        <h4>UI</h4>
        <label class="ui-row" for="themeSelect">Тема</label>
        <select id="themeSelect">
          <option value="light">Светлая</option>
          <option value="dark">Тёмная</option>
        </select>
        <label class="row">
          <input id="compactModeCheckbox" type="checkbox" style="width: auto" />
          Компактный интерфейс
        </label>

        <h4>Профиль и приватность</h4>
        <input id="avatarInput" type="file" accept="image/*" />
        <div id="avatarPreview" class="media-preview hidden"></div>
        <label class="row"
          ><input id="hideNameCheckbox" type="checkbox" style="width: auto" />
          Скрывать мое имя для других</label
        >
        <label class="row"
          ><input
            id="showOnlineStatusCheckbox"
            type="checkbox"
            style="width: auto"
          />
          Показывать мой онлайн-статус</label
        >
        <label class="row"
          ><input
            id="allowAvatarViewCheckbox"
            type="checkbox"
            style="width: auto"
          />
          Разрешить смотреть мой аватар</label
        >
        <label class="row"
          ><input
            id="allowAvatarDownloadCheckbox"
            type="checkbox"
            style="width: auto"
          />
          Разрешить скачивать мой аватар</label
        >

        <div class="push-row">
          <button id="togglePushBtn" type="button" class="secondary">
            Включить push-уведомления
          </button>
          <p id="pushStatus" class="muted"></p>
        </div>

        <div id="supportAdminPanel" class="hidden">
          <h4>Управление поддержкой</h4>
          <input
            id="supportAgentUsername"
            type="text"
            placeholder="username поддержки"
          />
          <input
            id="supportAgentPassword"
            type="password"
            placeholder="password поддержки"
          />
          <button id="createSupportAgentBtn" class="secondary">
            Создать аккаунт поддержки
          </button>
          <div id="supportAgentsList" class="results"></div>
        </div>

        <div class="row">
          <button id="saveSettingsBtn">Сохранить</button>
          <button id="cancelSettingsBtn" type="button" class="secondary">
            Закрыть
          </button>
        </div>
      </div>
    </div>

    <div id="toastContainer" class="toast-container"></div>

    <script src="/app.js"></script>
  </body>
</html>
